# Redis 사용 현황 분석 및 의견

## 1. 분석 요약

`"일단 redis는 느려지면 설정하고. 아님 굳이 필요없나 싶어서."` 라는 의견에 대해 코드베이스를 분석한 결과, 현재 **Redis는 이미 프로덕션(운영) 환경의 핵심 기능으로 완전히 통합**되어 있음을 확인했습니다.

단순히 사용을 염두에 둔 수준이 아니라, **애플리케이션의 주요 성능 최적화 지점(조회수, 인기 레시피/공구 조회)에 이미 캐싱 기능이 적용**되어 있습니다.

따라서 "나중에 설정"하는 것이 아니라, **"운영 환경에서는 반드시 필요"** 한 구성 요소입니다.

## 2. 근거

### 2.1. 의존성 및 설정 파일 (`build.gradle`, `application.yml`)

-   **`build.gradle`**: Redis 및 Spring Cache 사용에 필수적인 `spring-boot-starter-data-redis`, `spring-boot-starter-cache` 의존성이 이미 추가되어 있습니다.
-   **`application.yml`**:
    -   **`prod`(운영) 프로필**: `spring.cache.type`이 **`redis`** 로 설정되어 있습니다. 이는 운영 환경에서는 Redis를 캐시 저장소로 사용하겠다는 명시적인 설정입니다.
    -   **`dev`(개발) 프로필**: `spring.cache.type`이 **`none`** 으로 설정되어 있습니다. 개발 편의성을 위해 로컬 환경에서는 Redis 없이 동작하도록 의도적으로 비활성화한 것입니다. 이는 일반적인 모범 사례입니다.
    -   **`test` 프로필**: 캐시 타입이 `simple`(인메모리)로 설정되어, 테스트 코드 실행 시 Redis 서버가 필요 없도록 구성되어 있습니다.

### 2.2. 캐시 설정 클래스 (`src/main/java/com/recipemate/global/config/CacheConfig.java`)

-   `@EnableCaching` 어노테이션을 통해 프로젝트 전체에 캐싱 기능이 활성화되어 있습니다.
-   `@ConditionalOnProperty` 어노테이션을 통해 `spring.cache.type`이 `redis`일 경우에만 Redis 캐시 매니저가 동작하도록 설정되어 있습니다.
-   캐시 종류별로 만료 시간(TTL)을 다르게 설정하여 체계적으로 관리하고 있습니다.
    -   `recipes` 캐시: 1시간
    -   `popularGroupBuys` 캐시: 5분
    -   `viewCounts` 캐시: 1분

### 2.3. 실제 코드 사용 예시 (`@Cacheable` 어노테이션)

-   **`RecipeService.java`**: 인기 레시피, 레시피 상세 정보, 카테고리 목록 등 **반복적으로 조회될 가능성이 높은 레시피 관련 데이터**를 Redis에 캐싱하여 DB 조회를 최소화하고 있습니다.
-   **`GroupBuyService.java`**: **인기 공동구매 목록**을 캐싱하여 메인 페이지 등의 성능 저하를 방지하고 있습니다.
-   **`PostService.java`**: **게시글 조회수**를 캐싱하여, 조회수 증가 시 매번 DB 업데이트를 하지 않고 주기적으로 반영하는 효율적인 로직을 구현했습니다.

## 3. 결론 및 의견

현재 코드베이스는 **"Redis가 없어도 동작은 하지만, 성능을 위해 Redis를 적극적으로 활용"** 하도록 설계되어 있습니다.

만약 프로덕션 환경에서 Redis 설정을 제외하고 배포한다면 다음과 같은 문제가 발생합니다.

1.  **성능 저하**: 캐싱이 적용된 모든 기능(인기 레시피/공구 조회, 조회수 집계 등)이 매 요청마다 데이터베이스를 직접 조회하게 됩니다. 사용자가 많아지면 이는 심각한 DB 부하와 서비스 속도 저하로 이어질 것입니다.
2.  **의도하지 않은 동작**: `spring.cache.type` 설정을 `redis`가 아닌 `simple` 등으로 변경하여 배포할 수는 있습니다. 하지만 이 경우, 서버가 재시작될 때마다 모든 캐시가 초기화되거나, 여러 서버 인스턴스 간에 데이터가 공유되지 않는 문제가 발생합니다. 이는 Redis를 도입한 본래 목적과 완전히 어긋납니다.

따라서, **"느려지면 설정하는 것"이 아니라, 이미 "느려지는 것을 방지하기 위해 설정"** 된 상태입니다. Redis는 현재 프로젝트의 운영 환경에서 선택이 아닌 **필수 구성 요소**로 보아야 합니다.