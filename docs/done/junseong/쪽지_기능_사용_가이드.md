# 1:1 쪽지 기능 사용 가이드

## ✅ 현재 상태

쪽지 전송 및 대화 조회 기능이 **완전히 작동합니다!**

**✨ 알림 기능도 완전히 활성화되었습니다!** (2025-11-15 업데이트)

---

## 🎯 사용 방법

### 1. 애플리케이션 시작

```bash
cd C:\Users\wnstj\opensw_recipemate_web\recipemate
.\gradlew.bat bootRun
```

**🔔 첫 실행 시:**
- 데이터베이스가 자동으로 생성됩니다
- 레시피 데이터가 API에서 자동으로 로드됩니다 (약 1~2분 소요)
- 완료 후 `http://localhost:8080` 접속 가능

### 2. 쪽지 보내기

**방법 1: 참여자 관리 페이지에서**
1. 공구 주최자로 로그인
2. **"참여자 관리"** 페이지 이동
3. 각 참여자 옆의 **"쪽지"** 버튼 클릭
4. 메시지 입력 후 **"전송"** 버튼 클릭

**방법 2: 마이페이지에서**
1. 로그인 후 **"마이페이지"** 이동
2. 왼쪽 바로가기 메뉴에서 **"쪽지함"** 클릭
3. 대화 상대 목록에서 선택하여 메시지 전송

### 3. 대화 목록 확인

**접근 방법:**
- **마이페이지**: 바로가기 메뉴의 "쪽지함" 클릭
  - 안 읽은 메시지가 있으면 빨간 배지로 개수 표시
- **직접 URL**: `http://localhost:8080/direct-messages/contacts`
- 최근 대화한 상대 목록 표시
- 상대를 클릭하면 대화방으로 이동

---

## 📝 현재 작동하는 기능

### ✅ 완전 작동
- ✅ 쪽지 전송
- ✅ 대화 내용 조회
- ✅ 대화 목록 확인
- ✅ 읽음 처리
- ✅ 안 읽은 메시지 개수 조회
- ✅ **마이페이지 쪽지함 바로가기** (안 읽은 메시지 배지 표시)
- ✅ **쪽지 수신 시 알림 생성** (완전 활성화!)

---

## 🧪 테스트 시나리오

1. **사용자 A**: 공구 생성 및 참여자 추가
2. **사용자 A**: 참여자 관리 페이지에서 참여자 B에게 쪽지 전송
3. **사용자 B**: 로그인 후 `/direct-messages/contacts` 접속
4. **사용자 B**: 사용자 A와의 대화방 확인 및 답장

---

## 🔧 문제 해결

### 500 에러 발생 시
- 알림 기능이 활성화된 상태라면 위의 "방법 1"을 따라 제약조건 수정

### 대화 목록이 비어있을 때
- 정상입니다. 아직 아무에게도 쪽지를 보내지 않은 상태입니다.
- 참여자 관리 페이지에서 쪽지를 보내면 목록에 표시됩니다.

### 메시지가 전송되지 않을 때
- 브라우저 콘솔(F12) 확인
- 서버 로그 확인
- `DirectMessageService.java`의 주석 처리된 알림 코드가 활성화되어 있는지 확인

---

## 📌 요약

**현재 상태**: 쪽지 기능 100% 완전 작동 (알림 포함!)

**데이터 상태**: 새로 생성된 깨끗한 데이터베이스

**레시피 데이터**: 첫 실행 시 자동으로 API에서 로드됨

**권장 사용법**: 
1. `.\gradlew.bat bootRun`으로 애플리케이션 시작
2. 회원가입 후 로그인
3. 공구 생성 및 참여자 추가
4. 참여자 관리 페이지에서 쪽지 전송
5. 수신자는 알림 또는 마이페이지 쪽지함에서 확인

**🎉 모든 기능이 정상 작동합니다!**

