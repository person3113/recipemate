# 마이페이지 - 내가 작성한 댓글/게시글 기능 추가

## 📋 개요
마이페이지에 "내가 작성한 게시글"과 "내가 작성한 댓글" 목록을 볼 수 있는 기능을 추가했습니다.

## 🔧 변경된 파일

### 1. Repository 계층

#### PostRepository.java
- 추가: `findByAuthorIdAndDeletedAtIsNull(Long authorId, Pageable pageable)` 메서드
- 기능: 사용자가 작성한 게시글 조회 (삭제되지 않은 것만, 페이지네이션 지원)

#### CommentRepository.java
- 추가: `findByAuthorIdAndNotDeleted(Long authorId, Pageable pageable)` 메서드
- 기능: 사용자가 작성한 댓글 조회 (삭제되지 않은 것만, 페이지네이션 지원)
- LEFT JOIN FETCH를 사용하여 관련 게시글 및 공구 정보도 함께 로드

### 2. Controller 계층

#### UserController.java
- **새 의존성 추가**:
  - `PostRepository`
  - `CommentRepository`

- **새 엔드포인트 추가**:
  1. `GET /users/me/posts` - 내가 작성한 게시글 목록
  2. `GET /users/me/comments` - 내가 작성한 댓글 목록

### 3. View 계층

#### my-page.html
- 바로가기 섹션에 두 개의 링크 추가:
  - 📝 내가 작성한 게시글
  - 💬 내가 작성한 댓글

#### 새 템플릿 파일 생성

**my-posts.html** (내가 작성한 게시글)
- 게시글 목록 카드 형식으로 표시
- 각 게시글에 대해:
  - 카테고리 배지 (레시피, 꿀팁, 후기, 자유)
  - 제목, 내용 미리보기
  - 작성일, 조회수
  - 보기/수정/삭제 버튼
- 페이지네이션 지원
- 빈 상태 처리 (작성한 게시글이 없을 때)

**my-comments.html** (내가 작성한 댓글)
- 댓글 목록 카드 형식으로 표시
- 각 댓글에 대해:
  - 댓글 내용
  - 작성 대상 (게시글 또는 공구) 정보 및 링크
  - **삭제된 게시글/공구 표시**: `deletedAt` 필드 확인하여 삭제 여부 표시
    - 삭제된 경우: 제목에 취소선, "삭제됨" 배지 표시, 링크 비활성화
    - 삭제되지 않은 경우: 클릭 가능한 링크로 표시
  - 작성일
  - 대댓글 여부 표시
  - 원본 게시글/공구 보기 버튼 (삭제되지 않은 경우만)
  - 삭제 버튼
- 페이지네이션 지원
- 빈 상태 처리 (작성한 댓글이 없을 때)

## 🎨 UI/UX 특징

### 일관된 디자인
- 기존 마이페이지 템플릿들(my-group-purchases.html, bookmarks.html 등)과 동일한 디자인 패턴 사용
- Bootstrap 5.3.2 스타일 활용
- Bootstrap Icons 사용

### 사용자 친화적 기능
- 각 아이템에서 원본 컨텐츠로 바로 이동 가능
- 수정/삭제 기능 제공 (삭제 시 확인 대화상자)
- 빈 상태에서 관련 페이지로 이동할 수 있는 버튼 제공
- **삭제된 컨텐츠 처리**:
  - 삭제된 게시글/공구: 제목 옆에 🗑️ 아이콘과 빨간색 "삭제됨" 배지 표시
  - "보기" 버튼 비활성화하여 404 오류 방지
  - "원본이 삭제되었습니다" 안내 메시지 표시
  - 댓글은 여전히 삭제 가능 (사용자가 자신의 기록 관리 가능)

## 📊 데이터 흐름

```
사용자 → my-page.html (바로가기 클릭)
       ↓
UserController (/users/me/posts 또는 /users/me/comments)
       ↓
Repository (PostRepository 또는 CommentRepository)
       ↓
Database (삭제되지 않은 데이터만 조회, 페이지네이션)
       ↓
View (my-posts.html 또는 my-comments.html)
```

## 🔒 보안
- `@AuthenticationPrincipal`을 통해 현재 로그인한 사용자만 자신의 데이터 조회 가능
- 삭제 작업 시 CSRF 토큰 검증

## ✅ 구현 완료 사항

1. ✅ PostRepository에 사용자별 게시글 조회 메서드 추가
2. ✅ CommentRepository에 사용자별 댓글 조회 메서드 추가
3. ✅ UserController에 새 엔드포인트 추가
4. ✅ 마이페이지 템플릿에 바로가기 링크 추가
5. ✅ my-posts.html 템플릿 생성
6. ✅ my-comments.html 템플릿 생성
7. ✅ 빌드 성공 확인
8. ✅ 삭제 버튼 오류 수정
   - 게시글 삭제: `/api/posts/{id}` → `/community-posts/{id}/delete` 로 수정
   - 댓글 삭제: `/api/comments/{id}` → `/comments/{id}/delete` + 필수 파라미터 추가
   - 삭제 후 리다이렉트: 마이페이지로 돌아가도록 `redirectUrl` 파라미터 추가
10. ✅ 삭제된 게시글/공구 처리
    - 댓글 대상이 삭제된 경우 시각적으로 표시
    - 삭제된 항목에 대한 "보기" 버튼 비활성화
    - "삭제됨" 배지 및 안내 메시지 표시
9. ✅ 빈 상태 버튼 URL 수정
   - 커뮤니티 가기: `/community-posts` → `/community-posts/list`
   - 공동구매 가기: `/group-purchases` → `/group-purchases/list`

## 🚀 사용 방법

1. 마이페이지 접속: `/users/me`
2. 좌측 사이드바의 "바로가기" 섹션에서 선택:
   - "내가 작성한 게시글" 클릭 → 게시글 목록 페이지
   - "내가 작성한 댓글" 클릭 → 댓글 목록 페이지
3. 각 페이지에서 수정/삭제 또는 원본 보기 가능

## 📝 향후 개선 가능 사항

- [ ] 게시글/댓글 통계 (총 개수, 최근 활동 등)
- [ ] 필터링 기능 (카테고리별, 날짜별)
- [ ] 검색 기능
- [ ] 좋아요한 게시글 목록 (기획서에 언급됨)
- [ ] 일괄 삭제 기능

