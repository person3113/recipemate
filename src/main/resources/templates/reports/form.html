<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(
        ~{::title},
        ~{::main-content},
        ~{::additional-head},
        ~{::additional-scripts}
      )}">
<head>
    <th:block th:fragment="title">신고하기 - RecipeMate</th:block>
    
    <th:block th:fragment="additional-head">
        <!-- No additional head content needed -->
    </th:block>
</head>
<body>
    <main th:fragment="main-content" class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Page Title -->
                <div class="mb-4">
                    <h2 class="fw-bold">
                        <i class="bi bi-flag text-danger"></i> 신고하기
                    </h2>
                    <p class="text-muted">부적절한 콘텐츠나 행위를 신고해주세요.</p>
                </div>
                
                <!-- Warning Alert -->
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle"></i>
                    <strong>주의:</strong> 허위 신고는 불이익을 받을 수 있습니다. 신중하게 작성해주세요.
                </div>
                
                <!-- Report Form Card -->
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <form th:action="@{/reports}" method="post" id="reportForm">
                            <!-- Hidden Fields -->
                            <input type="hidden" name="reportedEntityType" th:value="${entityType}">
                            <input type="hidden" name="reportedEntityId" th:value="${entityId}">
                            
                            <!-- Reported Entity Info -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">신고 대상</label>
                                <div class="p-3 bg-light rounded">
                                    <div class="d-flex align-items-center">
                                        <span class="badge bg-primary me-2" th:text="${entityType}">TYPE</span>
                                        <span th:text="${entityName}">대상 정보</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Report Type -->
                            <div class="mb-4">
                                <label for="reportType" class="form-label fw-bold">
                                    신고 사유 <span class="text-danger">*</span>
                                </label>
                                <select class="form-select" name="reportType" id="reportType" required>
                                    <option value="">선택하세요</option>
                                    <option value="INAPPROPRIATE_CONTENT">부적절한 콘텐츠</option>
                                    <option value="SPAM">스팸/광고</option>
                                    <option value="ABUSE">욕설/비방</option>
                                    <option value="FALSE_INFORMATION">허위 정보</option>
                                    <option value="COPYRIGHT">저작권 침해</option>
                                    <option value="ETC">기타</option>
                                </select>
                            </div>
                            
                            <!-- Report Content -->
                            <div class="mb-4">
                                <label for="content" class="form-label fw-bold">
                                    상세 내용 <span class="text-danger">*</span>
                                </label>
                                <textarea class="form-control" 
                                          name="content" 
                                          id="content" 
                                          rows="6" 
                                          placeholder="신고 사유를 자세히 설명해주세요. (최소 10자 이상)"
                                          required
                                          minlength="10"
                                          maxlength="500"></textarea>
                                <div class="form-text">
                                    최소 10자 이상, 최대 500자까지 입력 가능합니다.
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-danger" id="submitBtn">
                                    <i class="bi bi-flag"></i> 신고 제출
                                </button>
                                <div th:replace="~{fragments/back-button :: cancel-button(url='/')}"></div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Info Box -->
                <div class="mt-4 p-3 bg-white rounded shadow-sm">
                    <h6 class="fw-bold mb-2">
                        <i class="bi bi-info-circle text-primary"></i> 신고 처리 안내
                    </h6>
                    <ul class="small text-muted mb-0">
                        <li>신고 내용은 관리자가 검토한 후 적절한 조치를 취합니다.</li>
                        <li>허위 신고나 악의적인 신고는 제재 대상이 될 수 있습니다.</li>
                        <li>신고 처리 결과는 알림을 통해 안내됩니다.</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>
    
    <th:block th:fragment="additional-scripts">
        <!-- Prevent Double Submit -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const reportForm = document.getElementById('reportForm');
                if (reportForm) {
                    reportForm.addEventListener('submit', function(e) {
                        const submitBtn = document.getElementById('submitBtn');
                        if (submitBtn.disabled) {
                            e.preventDefault();
                            return false;
                        }
                        submitBtn.disabled = true;
                        submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-1"></span> 제출 중...';
                    });
                }
            });
        </script>
    </th:block>
</body>
</html>
